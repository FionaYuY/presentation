import streamlit as st
import plotly.graph_objects as go
import pandas as pd

def render():
    """æ¸²æŸ“å¹•å¾ŒèŠ±çµ®é¡µé¢"""
    st.title("ğŸ¬ å¹•å¾ŒèŠ±çµ®ï¼šé€šå‹¤æˆ°å£«çš„è¡€æ·šå²")
    st.subheader("ç•¶åˆ¥äººåœ¨ç’°éŠä¸–ç•Œï¼Œæˆ‘åœ¨ç’°éŠå¤§å°åŒ—...")
    
    st.markdown("---")
    
    # è¡€æ·šæ•¸æ“š
    st.write("### ğŸ˜­ è¡€æ·šæ•¸æ“šå¤§å…¬é–‹")
    
    col1, col2, col3, col4 = st.columns(4)
    
    with col1:
        st.metric(
            label="æ¯æ—¥é€šå‹¤æ™‚é–“",
            value="3å°æ™‚",
            delta="ä¾†å›åœ°ç„"
        )
    
    with col2:
        st.metric(
            label="æ¯æœˆé€šå‹¤æ™‚é–“",
            value="60å°æ™‚",
            delta="ğŸ˜µ å¿«æ­»äº†"
        )
    
    with col3:
        st.metric(
            label="åŠå¹´é€šå‹¤æ™‚é–“",
            value="360å°æ™‚",
            delta="ğŸ’€ å·²æ­»"
        )
    
    with col4:
        st.metric(
            label="ç­‰æ–¼é€£çºŒåè»Š",
            value="15å¤©",
            delta="ğŸ˜± å´©æ½°"
        )
    
    st.markdown("---")
    
    # é£›è¡Œæ™‚é–“å°æ¯”
    st.write("### âœˆï¸ æˆ‘çš„é€šå‹¤æ™‚é–“ vs é£›è¡Œæ™‚é–“")
    st.write("**æ®˜é…·çš„ç¾å¯¦ï¼šæ¯å¤©é€šå‹¤3å°æ™‚ï¼Œæˆ‘å¯ä»¥...**")
    
    # å‰µå»ºé£›è¡Œæ™‚é–“å°æ¯”è¡¨
    flight_data = {
        "ç›®çš„åœ°": ["é¦™æ¸¯", "é¦¬å°¼æ‹‰", "å®¿éœ§", "æ¼¢åŸ", "æ±äº¬", "å¤§é˜ª"],
        "é£›è¡Œæ™‚é–“": ["1å°æ™‚40åˆ†", "2å°æ™‚00åˆ†", "2å°æ™‚30åˆ†", "2å°æ™‚20åˆ†", "2å°æ™‚50åˆ†", "2å°æ™‚15åˆ†"],
        "å‰©é¤˜æ™‚é–“": ["1å°æ™‚20åˆ†", "1å°æ™‚00åˆ†", "30åˆ†é˜", "40åˆ†é˜", "10åˆ†é˜", "45åˆ†é˜"],
        "å¯ä»¥åšä»€éº¼": ["å–å’–å•¡æ”¾ç©º", "é€›å…ç¨…åº—", "å°æ†©ä¸€ä¸‹", "åƒå€‹é£¯", "ç·Šæ€¥ç™»æ©Ÿ", "æ‚ é–’æ•£æ­¥"]
    }
    
    df = pd.DataFrame(flight_data)
    
    # ä½¿ç”¨ st.dataframe æ˜¾ç¤ºè¡¨æ ¼
    st.dataframe(
        df,
        use_container_width=True,
        hide_index=True
    )
    
    st.markdown("---")
    
    # å¿ƒé…¸å°æ¯”
    st.write("### ğŸ’” å¿ƒé…¸å°æ¯”æ™‚åˆ»")
    
    col1, col2 = st.columns(2)
    
    with col1:
        st.write("**ğŸš‡ æˆ‘çš„ç¾å¯¦**")
        reality_items = [
            "æ¯å¤©3å°æ™‚å›°åœ¨è»Šå»‚è£¡",
            "èè‘—å„ç¨®ã€Œé¦™å‘³ã€",
            "è¢«äººç¾¤æ“ åˆ°è®Šå½¢",
            "çœ‹è‘—çª—å¤–ä¸€æ¨£çš„é¢¨æ™¯",
            "åœ¨å¿ƒè£¡é»˜é»˜å€’æ•¸ç«™æ•¸"
        ]
        
        for item in reality_items:
            st.write(f"â€¢ {item}")
    
    with col2:
        st.write("**âœˆï¸ æœ‹å‹å€‘çš„æ—¥å¸¸**")
        friends_items = [
            "é£›åˆ°å¤§é˜ªåƒé“åœ°æ‹‰éºµ",
            "åœ¨é¦¬å°¼æ‹‰æµ·ç˜æ›¬å¤ªé™½",
            "é¦™æ¸¯è¡€æ‹¼è²·åˆ°æ‰‹è»Ÿ",
            "éŸ“åœ‹é¦–çˆ¾åƒçƒ¤è‚‰é…ç‡’é…’",
            "æ±äº¬è¿ªå£«å°¼æ¨‚åœ’å°–å«"
        ]
        
        for item in friends_items:
            st.write(f"â€¢ {item}")
    
    st.markdown("---")
    
    # é€šå‹¤æ™‚é–“å¯ä»¥åšçš„äº‹
    st.write("### ğŸ¤” 360å°æ™‚é€šå‹¤æ™‚é–“å¯ä»¥...")
    
    tab1, tab2, tab3 = st.tabs(["æ—…éŠç¯‡", "å­¸ç¿’ç¯‡", "å¨›æ¨‚ç¯‡"])
    
    with tab1:
        st.write("**ğŸŒ ç’°éŠä¸–ç•Œè¨ˆç•«**")
        travel_plans = [
            "ğŸ‡¯ğŸ‡µ æ±äº¬ä¾†å› 63è¶Ÿï¼ˆæ¯è¶Ÿ2å°æ™‚50åˆ†ï¼‰",
            "ğŸ‡°ğŸ‡· é¦–çˆ¾ä¾†å› 77è¶Ÿï¼ˆæ¯è¶Ÿ2å°æ™‚20åˆ†ï¼‰",
            "ğŸ‡­ğŸ‡° é¦™æ¸¯ä¾†å› 108è¶Ÿï¼ˆæ¯è¶Ÿ1å°æ™‚40åˆ†ï¼‰",
            "ğŸ‡µğŸ‡­ é¦¬å°¼æ‹‰ä¾†å› 90è¶Ÿï¼ˆæ¯è¶Ÿ2å°æ™‚ï¼‰",
            "ğŸï¸ å®¿éœ§ä¾†å› 72è¶Ÿï¼ˆæ¯è¶Ÿ2å°æ™‚30åˆ†ï¼‰"
        ]
        
        for plan in travel_plans:
            st.write(f"â€¢ {plan}")
    
    with tab2:
        st.write("**ğŸ“š å­¸ç¿’æˆé•·è¨ˆç•«**")
        learning_plans = [
            "ğŸ“– è®€å®Œ 120æœ¬æ›¸ï¼ˆæ¯æœ¬3å°æ™‚ï¼‰",
            "ğŸ“ å®Œæˆ 12å€‹ç·šä¸Šèª²ç¨‹ï¼ˆæ¯å€‹30å°æ™‚ï¼‰",
            "ğŸ—£ï¸ å­¸æœƒ 3ç¨®èªè¨€ï¼ˆæ¯ç¨®120å°æ™‚ï¼‰",
            "ğŸ’» ç²¾é€š 18å€‹ç¨‹å¼èªè¨€ï¼ˆæ¯å€‹20å°æ™‚ï¼‰",
            "ğŸ¨ æˆç‚ºè¨­è¨ˆå¤§å¸«ï¼ˆ360å°æ™‚ç·´ç¿’ï¼‰"
        ]
        
        for plan in learning_plans:
            st.write(f"â€¢ {plan}")
    
    with tab3:
        st.write("**ğŸ® å¨›æ¨‚æ”¾é¬†è¨ˆç•«**")
        entertainment_plans = [
            "ğŸ¬ çœ‹å®Œ 180éƒ¨é›»å½±ï¼ˆæ¯éƒ¨2å°æ™‚ï¼‰",
            "ğŸ® ç ´é—œ 36æ¬¾éŠæˆ²ï¼ˆæ¯æ¬¾10å°æ™‚ï¼‰",
            "â˜• å–æ‰ 1080æ¯å’–å•¡ï¼ˆæ¯æ¯20åˆ†é˜ï¼‰",
            "ğŸ˜´ ç¡è¦º 15å€‹æ•´å¤©ï¼ˆæ¯å¤©24å°æ™‚ï¼‰",
            "ğŸ§˜ å†¥æƒ³ 720æ¬¡ï¼ˆæ¯æ¬¡30åˆ†é˜ï¼‰"
        ]
        
        for plan in entertainment_plans:
            st.write(f"â€¢ {plan}")
    
    st.markdown("---")
    
    # é€šå‹¤æ™‚é–“åœ–è¡¨ - æ›´åŠ æˆ²åŠ‡æ€§
    st.write("### ğŸ“Š è¡€æ·šç´¯ç©åœ–è¡¨")
    
    # å‰µå»ºæ›´æˆ²åŠ‡æ€§çš„åœ–è¡¨
    months = ['1æœˆ', '2æœˆ', '3æœˆ', '4æœˆ', '5æœˆ', '6æœˆ']
    cumulative_hours = [60, 120, 180, 240, 300, 360]
    
    # å°æ‡‰çš„å¯ä»¥é£›è¡Œçš„æ¬¡æ•¸ï¼ˆä»¥å¤§é˜ªç‚ºä¾‹ï¼Œ2å°æ™‚15åˆ†ï¼‰
    osaka_trips = [h // 2.25 for h in cumulative_hours]
    
    fig = go.Figure()
    
    # æ·»åŠ é€šå‹¤æ™‚é–“ç·š
    fig.add_trace(go.Scatter(
        x=months,
        y=cumulative_hours,
        mode='lines+markers',
        name='ç´¯ç©é€šå‹¤æ™‚é–“',
        line=dict(color='#ff5722', width=4),
        marker=dict(size=12, color='#d32f2f', line=dict(color='#ff5722', width=2))
    ))
    
    # æ·»åŠ å¯é£›å¤§é˜ªæ¬¡æ•¸ï¼ˆå³è»¸ï¼‰
    fig.add_trace(go.Scatter(
        x=months,
        y=[t * 16 for t in osaka_trips],  # æ”¾å¤§ä»¥ä¾¿åœ¨åŒä¸€åœ–è¡¨é¡¯ç¤º
        mode='lines+markers',
        name='å¯é£›å¤§é˜ªæ¬¡æ•¸ (x16)',
        line=dict(color='#2196f3', width=3, dash='dash'),
        marker=dict(size=10, color='#1976d2'),
        yaxis='y2'
    ))
    
    fig.update_layout(
        title="2025ä¸ŠåŠå¹´é€šå‹¤è¡€æ·šå²",
        xaxis_title="æœˆä»½",
        yaxis_title="ç´¯ç©é€šå‹¤æ™‚é–“ï¼ˆå°æ™‚ï¼‰",
        yaxis2=dict(
            title="å¯é£›å¤§é˜ªæ¬¡æ•¸ï¼ˆè¶Ÿï¼‰",
            overlaying='y',
            side='right'
        ),
        template="plotly_dark",
        plot_bgcolor="rgba(0,0,0,0)",
        paper_bgcolor="rgba(0,0,0,0)",
        font=dict(color="#f5f5f5")
    )
    
    st.plotly_chart(fig, use_container_width=True)
    
    st.markdown("---")
    
    # å¿ƒéˆé›æ¹¯æ™‚åˆ»
    st.write("### ğŸ’ª é€šå‹¤æˆ°å£«çš„æ­£èƒ½é‡")
    
    col1, col2 = st.columns(2)
    
    with col1:
        st.info("ğŸ§  **æ„å¤–æ”¶ç©«**")
        st.write("â€¢ åœ¨æ·é‹ä¸Šæƒ³å‡ºäº†æœ€ä½³çš„ç³»çµ±æ¶æ§‹")
        st.write("â€¢ é€šå‹¤æ™‚é–“æˆç‚ºæ€è€ƒçš„é»ƒé‡‘æ™‚æ®µ")
        st.write("â€¢ ç·´å°±äº†åœ¨ä»»ä½•ç’°å¢ƒéƒ½èƒ½å°ˆæ³¨çš„èƒ½åŠ›")
    
    with col2:
        st.success("ğŸ¯ **æœªä¾†ç›®æ¨™**")
        st.write("â€¢ é ç«¯å·¥ä½œï¼ŒæŠŠé€šå‹¤æ™‚é–“æ‹¿ä¾†æ—…éŠ")
        st.write("â€¢ ç”¨ç¯€çœçš„æ™‚é–“çœŸæ­£é£›åˆ°é€™äº›åœ°æ–¹")
        st.write("â€¢ æŠŠé€šå‹¤ç¶“é©—å¯«æˆå‹µå¿—æ›¸ç±")
    
    st.markdown("---")
    
    st.error("ğŸ˜¤ **ç¸½çµ**: é›–ç„¶é€šå‹¤å¾ˆè¾›è‹¦ï¼Œä½†æˆ‘ç”¨é€™äº›æ™‚é–“å®Œæˆäº† 14 å€‹é …ç›®ï¼Œè­‰æ˜æ™‚é–“ç®¡ç†å°±æ˜¯ä¸€åˆ‡ï¼") 